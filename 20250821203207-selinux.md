---
title: SELinux
date: 2025-08-21T20:32:07Z
modified: 2025-08-29T09:51:43Z
tags:
  - 'security'
  - 'networking'
  - 'linux'
---

# SELinux

_Security-Enhanced Linux (SELinux)_

SELinux is an implementation of [Mandatory Access Control](20250821203751-mac.md) (MAC) developed by the [National Security Agency](20250821214131-nsa.md) (NSA).

## References

Gentoo wiki might be the best treatment on this subject that I've found so far...
* [SELinux - Gentoo wiki](https://wiki.gentoo.org/wiki/SELinux)
    * [SELinux/Quick introduction - Gentoo wiki](https://wiki.gentoo.org/wiki/SELinux/Quick_introduction) - This intro seems to be better than the RHCSA textbooks I have... this is a solid primer
    * [SELinux/Tutorials - Gentoo wiki](https://wiki.gentoo.org/wiki/SELinux/Tutorials) - Seems like a relatively complete/helpful guide to SELinux
* [What is SELinux?](https://www.redhat.com/en/topics/linux/what-is-selinux)
* [Using SELinux \| Red Hat Enterprise Linux \| 9 \| Red Hat Documentation](https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html-single/using_selinux/index)
* [Security-Enhanced Linux - Wikipedia](https://en.wikipedia.org/wiki/Security-Enhanced_Linux)

## How it works

 SELinux is a security subsystem that works inside the Linux kernel. It uses LSM hooks. SELinux permission checks happen after the [DAC](20250821205445-dac.md) checks.

## Terminology

* **LSM:** Linux Security Module.
* **Subject:** Any user or process that accesses an _object_.
* **Object:** A resource such as a file, dir, hw device, network interface, etc
* **Access:** Action performed by the _subject_ on an _object_
* **Policy:** A defined ruleset enforced system-wide
* **Context** (a.k.a label): A tag that stores security attributes for _subjects_ and _objects_.
* **Labeling:** A mapping of files with their stored _contexts_.
* **SELinux User:** Predefined user identities that are authorized for particular _roles_.
* **Role (RBAC):** Classifies what subjects (who) are allowed to access what _domains_ or _types_.
* **Type enforcement (TE):** Limits a _subjects_ access to _domains_ for processes and _types_ for files.
* **Type:** A group of _objects_ (files, dirs, ect.) that share the same _context_.
* **Domain:** Determines what access processes have (context they're allowed to run in).
* **Level (MLS and MCS):** _sensitivity:category_ values that defines the level of security in the _context_.

## SELinux commands

SELinux state and mode:

* getenforce
* sestatus

Listing contexts:

* ls -ldZ, ls -lZ
* id -Z
* ps -eZ
* seinfo --portcon=80
* seinfo

SELinux administration:

* setenforce
* semanage

Managing labels:

* `chcon -t net_conf_t /etc/resolv.conf`
* `restorecon /etc/resolv.conf`
* `semanage fcontext -l | grep resolv`
* `semanage fcontext -a -t net_conf_t /etc/puppet-resolv\.conf`
* `restorecon /etc/puppet-resolv.conf`

User management:

* `semanage login -a -s staff_u john`

### Common

How do I list all of the SELinux users?

```bash
seinfo -u
```

How do I show Linux and SELinux user mappings?

```bash
semanage login -l
```

How do I list SELinux contexts for ports?

```bash
semanage port -l
```

How do I list the SELinux context for all running processes?

```bash
ps -eZ
ps -efZ
```

How do I list the SELinux context of a file?

```bash
ls -lZ /etc/password
```

What file do I need to edit to configure SELinux to either enforcing or permissive persistently?

```bash
vim /etc/selinux/config
```

What command do I need to run to show the current SELinux operating mode?

```bash
getenforce
# or
sestatus
```

What command do I use to temporarily change the context of a directory and it's contents recursively?

```bash
chcon -vu user_u -t public_content_t /tmp/sedir1 -R
```

What command do I use to permanently set the file context of a directory and it's contents recursively?

```bash
semanage fcontext -a -s user_u -t public_content_t '/tmp/sedir1(/.*)?'
```

How do I restore the file context of a directory and it's contents recursively?

```bash
restorecon -Rv /tmp/sedir1
```

How do I add port 8010 with type http_port_t and protocol tcp to the policy?

```bash
semanage port -at http_port_t -p tcp 8010
```

How do I copy a file and preserve it's SELinux context?

```bash
cp --preserve=context file .
```

How do I list all of the current selinux boolean settings?

```bash
getsebool -a
sestatus -b
semanage boolean -l
```

How do I persistently set a selinux boolean?

```bash
setsebool -P nfs_export_all_rw off
semanage boolean -m -0 nfs_export_all_rw
```

How do I analyze all of the AVC records in the audit.log file?

```bash
sealert -a /var/log/audit/audit.log
```

How do I search the audit.log for recent selinux denies?

```bash
ausearch -m avc -ts recent
```

What command do I need to run to ensure that SELinux is fully disabled in the kernel at boot?

```bash
grubby --update-kernal ALL --args selinux=0
```

How do I look for selinux denies in the systemd journal?

```bash
journalctl | grep sealert
```

### Troubleshooting denials

* `ausearch -m avc -ts recent`

[SELinux/Logging - Gentoo wiki](https://wiki.gentoo.org/wiki/SELinux/Logging)

### SELinux packages

SELinux packages that need to be installed to run the commands above.

* setools-console - provides seinfo and sesearch commands
* selinux-policy-doc - provides selinux boolean man pages
* setroubleshoot-server - provides sealert command, and other graphical tools for troubleshooting selinux

## Related

* [RBAC](20220319105401-rbac.md)
* [MLS](20250821214856-mls.md)
* [MCS](20250821214931-mcs.md)
* [MAC](20220315174137-mac.md)
* [NSA](20250821214131-nsa.md)
