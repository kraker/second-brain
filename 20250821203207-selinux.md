---
title: SELinux
date: 2025-08-21T20:32:07Z
modified: 2025-08-22T22:02:20Z
tags:
  - 'security'
  - 'networking'
  - 'linux'
---

# SELinux

_Security-Enhanced Linux (SELinux)_

SELinux is an implementation of [Mandatory Access Control](20250821203751-mac.md) (MAC) developed by the [National Security Agency](20250821214131-nsa.md) (NSA).

## How it works

 SELinux is a security subsystem that works inside the Linux kernel. It uses LSM hooks.

 SELinux permission checks happen after the [DAC](20250821205445-dac.md) checks.


## Terminology

* **LSM:** Linux Security Module.
* **Subject:** Any user or process that accesses an _object_.
* **Object:** A resource such as a file, dir, hw device, network interface, etc
* **Access:** Action performed by the _subject_ on an _object_
* **Policy:** A defined ruleset enforced system-wide
* **Context** (a.k.a label): A tag that stores security attributes for _subjects_ and _objects_.
* **Labeling:** A mapping of files with their stored _contexts_.
* **SELinux User:** Predefined user identities that are authorized for particular _roles_.
* **Role (RBAC):** Classifies what subjects (who) are allowed to access what _domains_ or _types_.
* **Type enforcement (TE):** Limits a _subjects_ access to _domains_ for processes and _types_ for files.
* **Type:** A group of _objects_ (files, dirs, ect.) that share the same _context_.
* **Domain:** Determines what access processes have (context they're allowed to run in).
* **Level (MLS and MCS):** _sensitivity:category_ values that defines the level of security in the _context_.

## SELinux commands

SELinux state and mode:

* getenforce
* sestatus

Listing contexts:

* ls -ldZ, ls -lZ
* id -Z
* ps -eZ
* seinfo --portcon=80
* seinfo

SELinux administration:

* setenforce
* semanage

Managing labels:

* `chcon -t net_conf_t /etc/resolv.conf`
* `restorecon /etc/resolv.conf`
* `semanage fcontext -l | grep resolv`
* `semanage fcontext -a -t net_conf_t /etc/puppet-resolv\.conf`
* `restorecon /etc/puppet-resolv.conf`

User management:

* `semanage login -a -s staff_u john`

### Troubleshooting denials

* `ausearch -m avc -ts recent`

[SELinux/Logging - Gentoo wiki](https://wiki.gentoo.org/wiki/SELinux/Logging)

### SELinux packages

SELinux packages that need to be installed to run the commands above.



## References

Gentoo wiki might be the best treatment on this subject that I've found so far...
* [SELinux - Gentoo wiki](https://wiki.gentoo.org/wiki/SELinux)
    * [SELinux/Quick introduction - Gentoo wiki](https://wiki.gentoo.org/wiki/SELinux/Quick_introduction) - This intro seems to be better than the RHCSA textbooks I have... this is a solid primer
    * [SELinux/Tutorials - Gentoo wiki](https://wiki.gentoo.org/wiki/SELinux/Tutorials) - Seems like a relatively complete/helpful guide to SELinux
* [What is SELinux?](https://www.redhat.com/en/topics/linux/what-is-selinux)
* [Using SELinux \| Red Hat Enterprise Linux \| 9 \| Red Hat Documentation](https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html-single/using_selinux/index)
* [Security-Enhanced Linux - Wikipedia](https://en.wikipedia.org/wiki/Security-Enhanced_Linux)

## Related

* [RBAC](20220319105401-rbac.md)
* [MLS](20250821214856-mls.md)
* [MCS](20250821214931-mcs.md)
* [MAC](20220315174137-mac.md)
* [NSA](20250821214131-nsa.md)
